# Writeup

Denne opgave kan l칮ses helt separat af alle de andre - den er m친ske naturlig at g친 til, n친r ransomwaren er analyseret i [Nisseware: Dropper](../nisseware-dropper/) og [Nisseware: Encryption](../nisseware-encryption/), men kan fint l칮ses fra starten, og vil i virkeligheden ogs친 analyseres af en anden gruppe teknikere end selve ransomwaren i det virkelige liv 游땎

Vi har af forurettede f친et udleveret et screenshot af ransomnoten fra angrebet:

![Ransomnote](img/ransomnote.png)

Vigtigst er her den `ETH`-adresse, der er noteret hen mod bunden, samt informationen om, at pengene skal sendes p친 `Goerli blockchain`, et testing network for Ethereum.
Adressen er m친ske lidt tr칝ls at skrive af, men vi har i opgaveteksten ogs친 f친et udleveret et transaktions-id fra et tidligere offer, der valgte at betale en lille l칮sesum:

```
0x9cd44ec9f36db37817e4df33ffd069ef7fe8c5e1bb2f2ac227ad60ff5dd6dff3
```

Dette er lidt nemmere hurtigt at sl친 op, og vi kan s칮ge os frem til `Goerli Testnet Explorer`: https://goerli.etherscan.io/.
Her kan transaktionen (eller alternativt adressen fra ransomnoten) sl친s op:

https://goerli.etherscan.io/tx/0x9cd44ec9f36db37817e4df33ffd069ef7fe8c5e1bb2f2ac227ad60ff5dd6dff3

![Goerli testnet transaktion](img/eth-transaction.png)

Her er det altid interessant at klikke `Show More`, da en transaktion kan indeholde en smule input data - normalt hex encoded, men man kan v칝lge `View Input As -> UTF-8`:

![Data fra transaktionen](img/eth-trans-data.png)

I det her tilf칝lde er selve dataen en hexv칝rdi, der ligner et hash meget.
Det stemmer fint overens med ransomnoten, der skriver `VIGTIGT! Transaktionen skal indeholde dit ID i datafeltet`, hvorefter IDet vises.

I transaktionen kan vi se b친de afsender og modtager. Afsenderen kan selvf칮lgelig v칝re vigtig for at kunne identificere flere ofre, men her er vi mest interesseret i modtageren: https://goerli.etherscan.io/address/0xb4403d0eda1417d8f112d960cd251455dcd9b179 - sjovt nok samme adresse, der stod i ransomnoten og her, man starter fra, hvis man gad skrive den af manuelt:

![Nissebandens adresse](img/eth-bad1.png)

Her ses to indg친ende transaktioner, nok fra to forskellige ofre, samt en enkelt udadg친ende: https://goerli.etherscan.io/address/0xa63512cf03d9470e78cb7cd2de30b3042f80d30a.
Gruppen sender alts친 l칮sesummen videre til en anden adresse, m친ske for at vaske pengene eller bare overflytte til en samlet adresse.

P친 denne konto er der kun den ene transaktion fra `0xB4403D0EDA1417d8f112d960CD251455DCd9B179`, s친 den transaktion er interessant: https://goerli.etherscan.io/tx/0x0f5f2e1118da4e99b2d5bbfae98659b963261940400b74f0e265e6dae172b53e. Vi tjekker lige, om der er sendt tekst i datafeltet her ogs친, og det leder os til flaget, der indikerer, at vi har fundet gruppens bagvedliggende adresse:

![Flag i transaktionsdata](img/eth-flag.png)

Fun fact, de to indadg친ende transaktioner til gruppens adresse har f칮lgende hashes (alts친 IDer) som data:

```
144d61b3bd1bdeb246f3f8876a2ff662
b537533e4b8a5dcc90355a2095577ec5
```

Den 칮verste kan ikke crackes med default wordlist, men er hash af `NC3CTF`. Det kan den nederste dog, som hurtigt kan crackes til `nissen` 游땔

**Flag**

`NC3{cryp70_3r_4n0nym_b3t4l1ng5f0rm_r1gh7?}`
