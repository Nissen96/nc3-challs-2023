def xor(a, b):
    return bytes([x ^ y for x, y in zip(a, b)])

# Recover keystream using known (plaintext, ciphertext)-files
with open("7z.exe.nis", "rb") as f:
    ct_7z = f.read()

with open("7z2301-x64.exe", "rb") as f:
    pt_7z = f.read()

keystream = xor(pt_7z, ct_7z)

# Decrypt encrypted file using keystream
with open("BounceNBeep PlayCruiser.jpeg.nis", "rb") as f:
    ct_flag = f.read()

pt_flag = xor(ct_flag, keystream)

# Write decrypted file to disk
with open("BounceNBeep PlayCruiser.jpeg", "wb") as f:
    f.write(pt_flag)
